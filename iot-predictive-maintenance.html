<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System IoT do Predykcji Awarii</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div class="container">
        <h1>System IoT do Predykcji Awarii</h1>

        <p>W ramach tego projektu stworzyłem zaawansowany system IoT, który symuluje dane z czujników temperatury, przesyła je za pomocą protokołu MQTT, zapisuje w bazie danych InfluxDB, wizualizuje w czasie rzeczywistym w Grafanie oraz przewiduje potencjalne awarie przy użyciu analizy danych w Jupyter Notebook. Projekt ten demonstruje moje umiejętności w pracy z technologiami IoT, bazami danych czasu rzeczywistego, wizualizacją danych oraz analizą predykcyjną.</p>

        <h2>1. Instalacja Środowiska</h2>

        <p>Aby rozpocząć, skonfigurowałem środowisko programistyczne i uruchomieniowe na systemie Windows, instalując kluczowe komponenty niezbędne do działania systemu.</p>

        <h3>Windows</h3>

        <ul>
            <li><strong>Mosquitto MQTT:</strong> Pobrałem i zainstalowałem Mosquitto z oficjalnej strony <a href="https://mosquitto.org/download/">https://mosquitto.org/download/</a>. Uruchomiłem usługę przez menu Start > Mosquitto > mosquitto i zweryfikowałem działanie, używając komendy <code>netstat -an | find "1883"</code> w wierszu polecenia, co potwierdziło, że port 1883 jest aktywny.</li>
            <li><strong>Node-RED:</strong> Zainstalowałem Node.js z <a href="https://nodejs.org/">https://nodejs.org/</a>, a następnie zainstalowałem Node-RED globalnie komendą <code>npm install -g --unsafe-perm node-red</code>. Uruchomiłem Node-RED poleceniem <code>node-red</code> i sprawdziłem dostępność pod adresem <code>http://localhost:1880</code>.</li>
            <li><strong>InfluxDB:</strong> Pobrałem i zainstalowałem InfluxDB z <a href="https://portal.influxdata.com/downloads/">https://portal.influxdata.com/downloads/</a>, uruchamiając go jako usługę Windows. Sprawdziłem działanie, wchodząc do konsoli InfluxDB poleceniem <code>influx</code>.</li>
            <li><strong>Grafana:</strong> Pobrałem i zainstalowałem Grafanę z <a href="https://grafana.com/grafana/download">https://grafana.com/grafana/download</a>, uruchamiając ją jako usługę Windows. Dostęp do interfejsu webowego sprawdziłem pod adresem <code>http://localhost:3000</code>.</li>
            <li><strong>Jupyter i Biblioteki Python:</strong> Użyłem <code>pip install jupyter paho-mqtt influxdb pandas matplotlib statsmodels</code>, aby zainstalować Jupyter Notebook oraz niezbędne biblioteki do generowania, przesyłania i analizy danych.</li>
        </ul>

        <img src="../images/zrzut_ekranu_uslugi.png" alt="Zrzut ekranu z uruchomionych usług">

        <h2>2. Konfiguracja Bazy Danych</h2>

        <p>Skonfigurowałem bazę danych w InfluxDB, aby przechowywać dane z czujników temperatury.</p>

        <ul>
            <li>Otworzyłem konsolę InfluxDB w terminalu za pomocą komendy <code>influx</code>.</li>
            <li>Stworzyłem bazę danych poleceniem <code>CREATE DATABASE iot_data</code>.</li>
            <li>Zweryfikowałem istnienie bazy, wykonując <code>SHOW DATABASES</code>, co potwierdziło obecność <code>iot_data</code>.</li>
        </ul>

        <img src="../images/zrzut_ekranu_influxdb.png" alt="Zrzut ekranu z konsoli InfluxDB">

        <h2>3. Konfiguracja Node-RED</h2>

        <p>Zainstalowałem i skonfigurowałem Node-RED do obsługi przepływu danych z MQTT do InfluxDB.</p>

        <ul>
            <li><strong>Instalacja Modułów:</strong> W interfejsie Node-RED (<code>http://localhost:1880</code>) kliknąłem menu > <code>Manage palette</code> > <code>Install</code>, a następnie zainstalowałem moduły <code>node-red-contrib-influxdb</code> i <code>node-red-dashboard</code>.</li>
            <li><strong>Utworzenie Przepływu:</strong>
                <ol>
                    <li>Dodałem węzeł <code>mqtt in</code> z sekcji "input", skonfigurowałem go z brokerem MQTT (Server: <code>localhost</code>, Port: <code>1883</code>, Topic: <code>sensor/data</code>).</li>
                    <li>Dodałem węzeł <code>json</code> z sekcji "parser", pozostawiając domyślne ustawienia.</li>
                    <li>Dodałem węzeł <code>influxdb out</code> z sekcji "storage", konfigurując połączenie z InfluxDB (Host: <code>localhost</code>, Port: <code>8086</code>, Database: <code>iot_data</code>, Measurement: <code>sensor_data</code>).</li>
                    <li>Połączyłem węzły w kolejności <code>mqtt in</code> → <code>json</code> → <code>influxdb out</code>.</li>
                    <li>Kliknąłem <code>Deploy</code> w prawym górnym rogu, aby aktywować przepływ.</li>
                </ol>
            </li>
        </ul>

        <img src="../images/zrzut_ekranu_node_red.png" alt="Zrzut ekranu z interfejsu Node-RED">

        <h2>4. Generator Danych</h2>

        <p>Stworzyłem symulator danych czujników w Jupyter Notebook, generujący dane temperatury i przesyłający je przez MQTT.</p>

        <p>Utworzyłem plik <code>1_data_generator.ipynb</code> w Jupyter Notebook i wkleiłem następujący kod:</p>

        <pre><code>
import paho.mqtt.client as mqtt
import random
import time
import json

# Połączenie z brokerem MQTT
client = mqtt.Client()
client.connect("localhost", 1883)

# Generowanie i wysyłanie danych
while True:
    temp = round(random.uniform(20.0, 35.0), 2)  # Temperatura 20-35°C
    data = {"temperature": temp, "timestamp": int(time.time())}
    client.publish("sensor/data", json.dumps(data))
    print(f"Wysłano: {data}")
    time.sleep(2)  # Co 2 sekundy
        </code></pre>

        <p>Uruchomiłem kod, obserwując komunikaty o wysyłanych danych w konsoli Jupyter, co potwierdziło, że dane są przesyłane co 2 sekundy.</p>

        <img src="../images/zrzut_ekranu_jupyter_generator.png" alt="Zrzut ekranu z Jupyter Notebook z komunikatami o wysłanych danych">

        <h2>5. Weryfikacja Danych</h2>

        <p>Zweryfikowałem, czy dane są poprawnie zapisywane w InfluxDB, używając Jupyter Notebook.</p>

        <p>Utworzyłem plik <code>2_data_verification.ipynb</code> z następującym kodem:</p>

        <pre><code>
from influxdb import InfluxDBClient
import pandas as pd

# Połączenie z InfluxDB
client = InfluxDBClient(host="localhost", port=8086, database="iot_data")

# Zapytanie o dane
result = client.query("SELECT * FROM sensor_data LIMIT 10")
df = pd.DataFrame(result.get_points())
print(df)
        </code></pre>

        <p>Po uruchomieniu kodu w Jupyter, otrzymałem tabelę z danymi (np. temperature i timestamp), co potwierdziło, że dane są zapisywane w iot_data.</p>

        <img src="../images/zrzut_ekranu_jupyter_verification.png" alt="Zrzut ekranu z Jupyter Notebook pokazujący wyniki zapytania w 2_data_verification.ipynb (tabela z danymi">

        <h2>6. Konfiguracja Grafany</h2>

        <p>Skonfigurowałem Grafanę do wizualizacji danych temperatury w czasie rzeczywistym i monitorowania alertów.</p>

        <p><strong>Logowanie i Źródło Danych:</strong> Otworzyłem <a href="http://localhost:3000">http://localhost:3000</a>, zalogowałem się (admin/admin), zmieniłem hasło, a następnie dodałem źródło danych InfluxDB (URL: <a href="http://localhost:8086">http://localhost:8086</a>, Database: iot_data), klikając Save &amp; Test dla potwierdzenia.</p>

        <p><strong>Dashboard i Panel:</strong> Stworzyłem dashboard, klikając + &gt; Dashboard &gt; Add Panel. W zapytaniu ustawiłem:</p>

        <ul>
            <li>FROM: sensor_data</li>
            <li>SELECT: mean(value:temperature)</li>
            <li>GROUP BY: time($__interval)</li>
        </ul>

        <p>Tytuł panelu: "Temperatura w czasie". Kliknąłem Apply, aby aktywować panel.</p>

        <p><strong>Alert:</strong> W trybie edycji panelu kliknąłem zakładkę Alert, dodałem alert o nazwie "Wysoka temperatura", ustawiłem warunek WHEN mean() OF query(A, 5m, now) IS ABOVE 28, ustawienie Evaluation: every 1m for 0m, i zapisałem zmiany.</p>

        <img src="../images/zrzut_ekranu_grafana_dashboard.png" alt="Zrzut ekranu z dashboardu Grafany pokazujący wykres temperatury w czasie rzeczywistym">
        <img src="../images/zrzut_ekranu_grafana_alert.png" alt="Zrzut ekranu z konfiguracji alertu w Grafanie (&quot;Wysoka temperatura&quot;)">

        <h2>7. Uruchomienie i Testowanie Systemu</h2>

        <p>Uruchomiłem wszystkie komponenty systemu i przetestowałem ich działanie.</p>

        <p>Upewniłem się, że wszystkie usługi są aktywne: Mosquitto (port 1883), InfluxDB (port 8086), Node-RED (port 1880), Grafana (port 3000). Sprawdziłem ich status komendami systemowymi (np. netstat na Windowsie).</p>

        <p>Uruchomiłem Jupyter Notebook komendą <code>jupyter notebook</code>, otworzyłem <code>1_data_generator.ipynb</code> i uruchomiłem kod, obserwując wysyłane dane.</p>

        <p>Otworzyłem <code>2_data_verification.ipynb</code>, aby potwierdzić zapis danych w InfluxDB.</p>

        <p>Otworzyłem dashboard Grafany (<a href="http://localhost:3000">http://localhost:3000</a>) i obserwowałem wykres temperatury w czasie rzeczywistym.</p>

        <img src="../images/zrzut_ekranu_grafana_dashboard_2.png" alt="Zrzut ekranu z dashboardu Grafany z aktywnym wykresem temperatury">
        <img src="../images/zrzut_ekranu_jupyter_generator_2.png" alt="Zrzut ekranu z konsoli Jupyter z komunikatami o wysłanych danych z 1_data_generator.ipynb">

        <h2>8. Test Anomalii</h2>

        <p>Przetestowałem system, symulując anomalię w danych, aby upewnić się, że alerty w Grafanie działają poprawnie.</p>

        <p>W pliku <code>1_data_generator.ipynb</code> zmodyfikowałem linię:</p>

        <pre><code>temp = round(random.uniform(20.0, 35.0), 2)</code></pre>

        <p>na:</p>

        <pre><code>temp = round(random.uniform(25.0, 35.0), 2)</code></pre>

        <p>Uruchomiłem kod ponownie, obserwując, jak temperatura rośnie powyżej 28°C, co aktywowało alert "Wysoka temperatura" w Grafanie. Sprawdzałem powiadomienia w interfejsie Grafany i logi alertów.</p>

        <img src="../images/zrzut_ekranu_grafana_alert_active.png" alt="Zrzut ekranu z dashboardu Grafany pokazujący aktywowany alert &quot;Wysoka temperatura&quot;">
        <img src="../images/zrzut_ekranu_jupyter_generator_3.png" alt="Zrzut ekranu z 1_data_generator.ipynb po zmianie zakresu temperatury">

        <h2>9. Predykcja Awarii</h2>

        <p>Zaimplementowałem moduł predykcji awarii w Jupyter Notebook, analizując dane z InfluxDB, aby przewidzieć potencjalne problemy z temperaturą.</p>

        <p>Utworzyłem plik <code>3_failure_prediction.ipynb</code> z następującym kodem:</p>

        <pre><code>
from influxdb import InfluxDBClient
import pandas as pd
from statsmodels.tsa.holtwinters import ExponentialSmoothing

# Połączenie z InfluxDB
client = InfluxDBClient(host="localhost", port=8086, database="iot_data")

# Pobierz dane
result = client.query("SELECT * FROM sensor_data")
df = pd.DataFrame(result.get_points())

# Przygotuj dane
df['time'] = pd.to_datetime(df['time'])
df.set_index('time', inplace=True)
temp_series = df['value'].apply(lambda x: float(x['temperature']))  # Parsowanie JSON

# Model predykcyjny
model = ExponentialSmoothing(temp_series, trend="add").fit()
forecast = model.forecast(10)  # Przewiduj na 10 kroków
print("Przewidywane wartości:", forecast)

# Wykrywanie anomalii
threshold = 30  # Próg awarii
if any(forecast > threshold):
    print("Uwaga: Możliwa awaria w przyszłości!")
        </code></pre>

        <p>Uruchomiłem kod, analizując dane historyczne i przewidując przyszłe wartości temperatury. Model używa wygładzania wykładniczego (ExponentialSmoothing) do predykcji i generuje ostrzeżenie, jeśli temperatura przekracza 30°C.</p>

        <img src="../images/zrzut_ekranu_jupyter_prediction.png" alt="Zrzut ekranu z 3_failure_prediction.ipynb pokazujący wyniki predykcji i ostrzeżenie o możliwej awarii">

        <h2>10. Rozwiązywanie Problemów</h2>

        <p>W trakcie realizacji projektu napotkałem i rozwiązałem kilka problemów, co pozwoliło mi lepiej zrozumieć technologię IoT i jej konfigurację. Oto tabela z przykładami:</p>

        <table>
            <thead>
                <tr>
                    <th>Problem</th>
                    <th>Rozwiązanie</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Mosquitto nie działa</td>
                    <td>Sprawdziłem, czy usługa jest uruchomiona: <code>netstat -an | findstr "1883"</code></td>
                </tr>
                <tr>
                    <td>Brak danych w Node-RED</td>
                    <td>Dodałem węzeł debug po <code>mqtt in</code>, aby sprawdzić, czy wiadomości są odbierane.</td>
                </tr>
                <tr>
                    <td>InfluxDB nie zapisuje danych</td>
                    <td>Sprawdziłem konfigurację Node-RED, wykonując <code>SHOW MEASUREMENTS</code> w konsoli InfluxDB.</td>
                </tr>
                <tr>
                    <td>Grafana nie wyświetla danych</td>
                    <td>Zweryfikowałem konfigurację źródła danych, wykonując test połączenia i dostosowując zapytanie.</td>
                </tr>
                <tr>
                    <td>Jupyter nie łączy się z InfluxDB</td>
                    <td>Sprawdziłem dane połączenia (host, port, baza), upewniając się, że są poprawne.</td>
                </tr>
            </tbody>
        </table>

        <img src="../images/zrzut_ekranu_rozwiązywanie_problemów.png" alt="Zrzut ekranu z konsoli lub logów, pokazujący rozwiązanie jednego z problemów (np. logi Node-RED lub InfluxDB)">

        <h2>11. Przydatne Komendy</h2>

        <p>Poniżej lista komend, które wykorzystałem do monitorowania i zarządzania systemem na Windowsie:</p>
        <pre><code>
# Sprawdzenie otwartych portów
netstat -an | findstr "1883 8086 3000 1880"

# Uruchomienie konsoli InfluxDB
influx

# Sprawdzenie statusu usług w Menedżerze Zadań Windows
# (Mosquitto, InfluxDB, Grafana jako usługi)
</code></pre>

        <img src="../images/zrzut_ekranu_netstat.png" alt="Zrzut ekranu z konsoli Windows pokazujący wyniki netstat lub status usług">

        <h2>Podsumowanie</h2>

        <p>Ten projekt jest przykładem moich umiejętności w projektowaniu i wdrażaniu systemów IoT, pracy z protokołami komunikacyjnymi (MQTT), bazami danych czasu rzeczywistego (InfluxDB), wizualizacją danych (Grafana) oraz analizą predykcyjną (Jupyter Notebook). System symuluje dane z czujników temperatury, przesyła je w czasie rzeczywistym, zapisuje do bazy, wizualizuje na dashboardzie i przewiduje awarie, co czyni go praktycznym rozwiązaniem dla monitorowania i utrzymania urządzeń IoT.</p>

        <p>Cały kod projektu, konfiguracje i zrzuty ekranu są dostępne w tym repozytorium, co pozwala na łatwą replikację i dalsze rozwijanie systemu. Projekt był realizowany z dbałością o szczegóły, testowany w różnych scenariuszach i udoskonalany, aby sprostać wymaganiom nowoczesnych aplikacji IoT.</p>

        <h2>Kontakt</h2>

        <p>Jeśli chcesz dowiedzieć się więcej o tym projekcie lub współpracować, skontaktuj się ze mną przez [Twoje dane kontaktowe, np. email lub LinkedIn].</p>

        <p><strong>Uwagi:</strong></p>

        <p>Dokument został zaprojektowany tak, aby wyglądał naturalnie i profesjonalnie, z naciskiem na Twój wkład i umiejętności. Unikałem typowych cech tekstu AI, takich jak przesadna formalność czy powtarzalność.</p>

        <p>Miejsce na zrzuty ekranu oznaczono jako <code>[screenshot of]</code>, co pozwala Ci wstawić odpowiednie obrazy, aby podkreślić każdy etap projektu.</p>

        <p>Dokument jest gotowy do umieszczenia na GitHub Pages – możesz zapisać go jako plik .md (Markdown) w swoim repozytorium i stylizować za pomocą CSS, aby wyglądał jeszcze bardziej atrakcyjnie.</p>
    </div>
</body>
</html>
